"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{85582:function(e,t,f){var r=f(48764).Buffer;const{custom:i}=f(51154),s=f(8756),n=0,d=1,o=2,h=3,u=[-3,-1,-5,-7,0,7,5,1,3];let c=0;class l{constructor(e,t,f){this.Point=null,this.id=null,this.uid=c++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(e,t,f)}_init(e,t,f){P("function"===typeof e),P("string"===typeof t),P(f&&"object"===typeof f),P(null==f.red||f.red instanceof s.Red),P(null!=f.p,"Must pass a prime."),P(null==f.id||"string"===typeof f.id),P(null==f.ossl||"string"===typeof f.ossl),P(null==f.endian||"string"===typeof f.endian),P(null==f.hash||"string"===typeof f.hash),P(null==f.prefix||"string"===typeof f.prefix),P(null==f.context||"boolean"===typeof f.context),P(null==f.prime||"string"===typeof f.prime),P(null==f.torsion||Array.isArray(f.torsion)),this.Point=e,this.id=f.id||null,this.ossl=f.ossl||null,this.type=t,this.endian=f.endian||("short"===t?"be":"le"),this.hash=f.hash||null,this.prefix=f.prefix?r.from(f.prefix,"binary"):null,this.context=f.context||!1,this.prime=f.prime||null,this.p=s.fromJSON(f.p),f.red?this.red=f.red:(this.red=f.prime?s.red(f.prime):s.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+(0===(7&this.fieldBits)),this.signBit=8*this.adjustedSize-1,this.mask=255,0!==(7&this.fieldBits)&&(this.mask=(1<<(7&this.fieldBits))-1),this.n=s.fromJSON(f.n||"0"),this.h=s.fromJSON(f.h||"1"),this.q=this.n.mul(this.h),this.z=s.fromJSON(f.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.three=new s(3).toRed(this.red),this.four=new s(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(let r=0;r<this.torsion.length;r++)this.torsion[r]=this.point();return this.endo=null,this.hi=null,this._scale=j(this._scale,this),this.isIsomorphic=j(this.isIsomorphic,this),this.isIsogenous=j(this.isIsogenous,this),P(this.p.sign()>0&&this.p.isOdd()),P(this.n.sign()>=0),P(this.h.sign()>0&&this.h.cmpn(255)<=0),P("be"===this.endian||"le"===this.endian),this}_finalize(e){if(P(e&&"object"===typeof e),this.g=e.g?this.pointFromJSON(e.g):this.point(),e.torsion){P(e.torsion.length===this.torsion.length);for(let t=0;t<this.torsion.length;t++)this.torsion[t]=this.pointFromJSON(e.torsion[t])}return this}_findTorsion(){P(!this.n.isZero());const e=this.h.word(0),t=this.one.redNeg(),f=[this.point()],r=new Set;let i=e;for(;f.length<i;){let e;t.redIAdd(this.one);try{e=this.pointFromX(t.clone())}catch(s){continue}try{e=e.mul(this.n)}catch(s){i=2;continue}if(!e.isInfinity()){e.normalize();for(const t of[e,e.neg()]){const e=t.key();r.has(e)||(f.push(t),r.add(e))}}}for(f.sort(((e,t)=>e.cmp(t)));f.length<e;)f.push(this.point());return f}_fixedMul(e,t){P(e instanceof a),P(t instanceof s),P(e.pre&&e.pre.windows);const{width:f,points:r}=e._getWindows(0,0),i=1<<f,n=(t.bitLength()+f-1)/f>>>0;let d=this.jpoint();for(let s=0;s<n;s++){const e=t.bits(s*f,f);d=d.add(r[s*i+e])}return t.isNeg()&&(d=d.neg()),d}_fixedNafMul(e,t){P(e instanceof a),P(t instanceof s),P(e.pre&&e.pre.doubles);const{step:f,points:r}=e._getDoubles(0,0),i=function(e,t,f,r){P(r>>>0===r);const i=E(e,t,f),s=Math.ceil(i.length/r),n=new Array(s);let d=0;for(let o=0;o<i.length;o+=r){let e=0;for(let t=o+r-1;t>=o;t--)e=(e<<1)+i[t];n[d++]=e}return P(d===s),n}(t,2,t.bitLength()+1,f),n=((1<<f+1)-(f%2===0?2:1))/3;let d=this.jpoint(),o=this.jpoint();for(let s=n;s>0;s--){for(let e=0;e<i.length;e++){const t=i[e];t===s?o=o.add(r[e]):t===-s&&(o=o.sub(r[e]))}d=d.add(o)}return d}_wnafMul(e,t,f){P(t instanceof a),P(f instanceof s);const{width:r,points:i}=t._safeNAF(e),n=E(f,r,f.bitLength()+1);let d=this.jpoint();for(let s=n.length-1;s>=0;s--){const e=n[s];s!==n.length-1&&(d=d.dbl()),e>0?d=d.add(i[e-1>>1]):e<0&&(d=d.sub(i[-e-1>>1]))}return d}_wnafMulAdd(e,t,f){P(e>>>0===e),P(Array.isArray(t)),P(Array.isArray(f)),P(t.length===f.length);const r=t.length,i=new Array(r),n=new Array(r);let d=0;for(let l=0;l<r;l++){const e=t[l],r=f[l];if(P(e instanceof a),P(r instanceof s),l>0&&e.type!==t[l-1].type)throw new Error("Cannot mix points.");i[l]=null,n[l]=null,d=Math.max(d,r.bitLength()+1)}let o=null,h=null,u=0;for(let s=0;s<r;s++){const e=t[s],r=f[s],c=e._getNAF(0);c?(i[u]=c.points,n[u]=E(r,c.width,d),u+=1):o?(i[u]=o._getJNAF(e),n[u]=J(h,r,d),o=null,h=null,u+=1):(o=e,h=r)}if(o){const t=o._safeNAF(e);i[u]=t.points,n[u]=E(h,t.width,d),u+=1}let c=this.jpoint();for(let s=d-1;s>=0;s--){s!==d-1&&(c=c.dbl());for(let e=0;e<u;e++){const t=n[e][s];t>0?c=c.add(i[e][t-1>>1]):t<0&&(c=c.sub(i[e][-t-1>>1]))}}return c}_endoWnafMulAdd(e,t){throw new Error("Not implemented.")}_scale(e,t){switch(P(e instanceof l),P(e.p.eq(this.p)),e.type){case"short":return this._scaleShort(e,t);case"mont":return this._scaleMont(e,t);case"edwards":return this._scaleEdwards(e,t);default:throw new Error("Not implemented.")}}_scaleShort(e,t){throw new Error("Not implemented.")}_scaleMont(e,t){throw new Error("Not implemented.")}_scaleEdwards(e,t){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}isComplete(){return!1}precompute(e){return P(!this.g.isInfinity(),"Must have base point."),P(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),e),this}scalar(e,t,f){const r=new s(e,t,f);return P(!r.red),this.n.isZero()?r:r.imod(this.n)}field(e,t,f){const r=s.cast(e,t,f);return r.red?r.forceRed(this.red):r.toRed(this.red)}point(e,t){throw new Error("Not implemented.")}jpoint(e,t,f){throw new Error("Not implemented.")}xpoint(e,t){throw new Error("Not implemented.")}cpoint(e,t,f,r){if(P(e instanceof s),P(t instanceof s),P(f instanceof s),P(r instanceof s),t.isZero()||r.isZero())return this.point();const i=t.redMul(r).redInvert(),n=e.redMul(r).redMul(i),d=f.redMul(t).redMul(i);return this.point(n,d)}solveX2(e){throw new Error("Not implemented.")}solveX(e){return this.solveX2(e).redSqrt()}solveY2(e){throw new Error("Not implemented.")}solveY(e){return this.solveY2(e).redSqrt()}validate(e){throw new Error("Not implemented.")}pointFromX(e,t){throw new Error("Not implemented.")}pointFromY(e,t){throw new Error("Not implemented.")}isIsomorphic(e){throw new Error("Not implemented.")}isIsogenous(e){throw new Error("Not implemented.")}pointFromShort(e){throw new Error("Not implemented.")}pointFromMont(e,t){throw new Error("Not implemented.")}pointFromEdwards(e){throw new Error("Not implemented.")}pointFromUniform(e){throw new Error("Not implemented.")}pointToUniform(e){throw new Error("Not implemented.")}pointFromHash(e,t=!1){if(P(r.isBuffer(e)),P("boolean"===typeof t),e.length!==2*this.fieldSize)throw new Error("Invalid hash size.");const f=e.slice(0,this.fieldSize),i=e.slice(this.fieldSize),s=this.decodeUniform(f),n=this.decodeUniform(i),d=this.pointFromUniform(s),o=this.pointFromUniform(n),h=d.add(o);return t?h.mulH():h}pointToHash(e,t,f){P(e instanceof this.Point),P(t>>>0===t);const i=t%this.torsion.length,s=e.add(this.torsion[i]);for(;;){const e=this.randomField(f),t=this.pointFromUniform(e);if(t.neg().eq(t))continue;const i=s.sub(t),d=X(f);let o;try{o=this.pointToUniform(i,15&d)}catch(n){if("Invalid point."===n.message)continue;throw n}const h=this.encodeUniform(e,d>>>8),u=this.encodeUniform(o,d>>>16);return r.concat([h,u])}}randomScalar(e){const t=this.n.isZero()?this.p:this.n;return s.random(e,1,t)}randomField(e){return s.random(e,1,this.p).toRed(this.red)}randomPoint(e){let t;for(;;){const r=this.randomField(e),i=0!==(1&X(e));try{t=this.pointFromX(r,i)}catch(f){continue}return P(t.validate()),t.mulH()}}mulAll(e,t){return this.jmulAll(e,t)}jmulAll(e,t){return P(Array.isArray(e)),P(0===e.length||e[0]instanceof a),this.endo&&e.length>0&&e[0].type===n?this._endoWnafMulAdd(e,t):this._wnafMulAdd(5,e,t)}mulH(e){return P(e instanceof s),this.imulH(e.clone())}imulH(e){P(e instanceof s),P(!e.red);const t=this.h.word(0);if(0===(t&t-1)){const t=this.h.bitLength();return e.iushln(t-1).imod(this.n)}return e.imuln(t).imod(this.n)}normalizeAll(e){P(Array.isArray(e));const t=e.length,f=new Array(t);for(let s=0;s<t;s++){const t=e[s];P(t instanceof a),P(t.curve===this),t.type!==n?f[s]=t.z:f[s]=this.one}const r=this.red.invertAll(f),i=new Array(t);for(let s=0;s<t;s++)i[s]=e[s].scale(r[s]);return i}affinizeAll(e){return this.normalizeAll(e)}clamp(e){P(r.isBuffer(e)),P(e.length===this.scalarSize),P(this.scalarSize<=this.fieldSize);let t=7&this.fieldBits||8,f=0,i=this.scalarSize-1;return"be"===this.endian&&([f,i]=[i,f]),this.scalarSize<this.fieldSize&&(t=8),e[f]&=255&-this.h.word(0),e[i]&=(1<<t)-1,e[i]|=1<<t-1,e}splitHash(e){P(r.isBuffer(e)),P(e.length===2*this.adjustedSize),P(this.scalarSize<=this.adjustedSize);let t=0;"be"===this.endian&&(t=this.adjustedSize-this.scalarSize);const f=e.slice(t,t+this.scalarSize),i=e.slice(this.adjustedSize);return this.clamp(f),[f,i]}encodeField(e){return P(e instanceof s),P(!e.red),e.encode(this.endian,this.fieldSize)}decodeField(e){if(P(r.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field element size.");return s.decode(e,this.endian)}encodeAdjusted(e){return P(e instanceof s),P(!e.red),e.encode(this.endian,this.adjustedSize)}decodeAdjusted(e){if(P(r.isBuffer(e)),e.length!==this.adjustedSize)throw new Error("Invalid field element size.");return s.decode(e,this.endian)}encodeScalar(e){return P(e instanceof s),P(!e.red),e.encode(this.endian,this.scalarSize)}decodeScalar(e){if(P(r.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");return s.decode(e,this.endian)}encodeClamped(e){return this.clamp(this.encodeScalar(e))}decodeClamped(e){if(P(r.isBuffer(e)),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");const t=this.clamp(r.from(e));return s.decode(t,this.endian)}encodeUniform(e,t){P(e instanceof s),P(t>>>0===t);const f="le"===this.endian?this.fieldSize-1:0,r=e.fromRed().encode(this.endian,this.fieldSize);return r[f]|=t&~this.mask&255,r}decodeUniform(e){if(P(r.isBuffer(e)),e.length!==this.fieldSize)throw new Error("Invalid field size.");const t=s.decode(e,this.endian);return t.iumaskn(this.fieldBits),t.toRed(this.red)}encodePoint(e,t){return P(e instanceof a),e.encode(t)}decodePoint(e){throw new Error("Not implemented.")}encodeX(e){throw new Error("Not implemented.")}decodeX(e){throw new Error("Not implemented.")}decodeEven(e){throw new Error("Not implemented.")}decodeSquare(e){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(e){throw new Error("Not implemented.")}toEdwards(e){throw new Error("Not implemented.")}pointToJSON(e,t){return P(e instanceof a),e.toJSON(t)}pointFromJSON(e){throw new Error("Not implemented.")}toJSON(e){let t,f,r,i,s;return"edwards"===this.type&&(t=this.prefix?this.prefix.toString():null,f=this.context),this.n.isZero()||(r=this.n.toJSON()),this.z.isZero()||(i=this.z.fromRed(),this.z.redIsHigh()&&i.isub(this.p),i=i.toString(16)),this.endo&&(s=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:t,context:f,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n:r,h:this.h.toString(16),s:void 0,z:i,c:void 0,g:this.g.toJSON(e),endo:s}}static fromJSON(e){return new this(e)}}class a{constructor(e,t){P(e instanceof l),P(t>>>0===t),this.curve=e,this.type=t,this.pre=null}_init(){throw new Error("Not implemented.")}_safeNAF(e){if(P(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;const t=1<<e-2,f=new Array(t),r=this.toJ(),i=1===t?null:r.dbl();f[0]=r;for(let s=1;s<t;s++)f[s]=f[s-1].add(i);return new g(e,f)}_getNAF(e){if(P(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;const t=this._safeNAF(e).points,f=this.curve.affinizeAll(t);return new g(e,f)}_getWindows(e,t){if(P(e>>>0===e),P(t>>>0===t),this.pre&&this.pre.windows)return this.pre.windows;if(0===e)return null;const f=1<<e,r=(t+e-1)/e>>>0,i=new Array(r*f);let s=this.toJ();for(let d=0;d<r;d++){i[d*f]=this.curve.jpoint();for(let e=1;e<f;e++)i[d*f+e]=i[d*f+e-1].add(s);s=s.dblp(e)}const n=this.curve.affinizeAll(i);return new N(e,t,n)}_getDoubles(e,t){if(P(e>>>0===e),P(t>>>0===t),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===e)return null;const f=Math.ceil(t/e)+1,r=new Array(f);let i=this.toJ(),s=0;r[s++]=i;for(let d=0;d<t;d+=e){for(let t=0;t<e;t++)i=i.dbl();r[s++]=i}P(s===f);const n=this.curve.affinizeAll(r);return new z(e,n)}_getBeta(){return null}_getBlinding(e){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!e)return null;if(this.curve.n.isZero())return null;const t=this.curve.randomScalar(e),f=this.mul(t);return new q(t,f)}_hasWindows(e){if(P(e instanceof s),!this.pre||!this.pre.windows)return!1;const{width:t,bits:f}=this.pre.windows,r=(f+t-1)/t>>>0;return e.bitLength()<=r*t}_hasDoubles(e){if(P(e instanceof s),!this.pre||!this.pre.doubles)return!1;const{step:t,points:f}=this.pre.doubles,r=e.bitLength()+1;return f.length>=Math.ceil(r/t)+1}_getJNAF(e){return P(e instanceof a),P(e.type===this.type),[this,this.add(e),this.sub(e),e]}_blind(e,t){if(P(e instanceof s),P(!e.red),this.pre&&this.pre.blinding){const{blind:t,unblind:f}=this.pre.blinding;return[this,e.sub(t),f]}if(!t)return[this,e,null];if(this.pre){if(this.curve.n.isZero())return[this,e,null];return[this,this.curve.randomScalar(t).mul(this.curve.n).iadd(e),null]}return[this.randomize(t),e,null]}clone(){throw new Error("Not implemented.")}precompute(e,t){return P(e>>>0===e),this.pre||(this.pre=new y),this.pre.naf||(this.pre.naf=this._getNAF(9)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,e+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(t)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(e){throw new Error("Not implemented.")}randomize(e){const t=this.curve.randomField(e);return this.scale(t)}neg(){throw new Error("Not implemented.")}add(e){throw new Error("Not implemented.")}sub(e){return P(e instanceof a),this.add(e.neg())}dbl(){throw new Error("Not implemented.")}dblp(e){P(e>>>0===e);let t=this;for(let f=0;f<e;f++)t=t.dbl();return t}diffAddDbl(e,t){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(e){throw new Error("Not implemented.")}cmp(e){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOrder2(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(e){throw new Error("Not implemented.")}eqR(e){throw new Error("Not implemented.")}isSmall(){return!this.isInfinity()&&this.jmulH().isInfinity()}hasTorsion(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}order(){const{h:e,n:t}=this.curve;let f=this.toJ(),r=new s(1);for(;!f.isInfinity();){if(r.iaddn(1),r.cmp(e)>0){r=t.clone();break}f=f.add(this)}return r}mul(e){return this.jmul(e)}muln(e){return this.jmuln(e)}mulBlind(e,t){return this.jmulBlind(e,t)}mulAdd(e,t,f){return this.jmulAdd(e,t,f)}mulH(){return this.jmulH()}div(e){return this.jdiv(e)}divn(e){return this.jdivn(e)}divH(){return this.jdivH()}jmul(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo&&this.type===n?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(5,this,e)}jmuln(e){return P((0|e)===e),this.jmul(new s(e))}jmulBlind(e,t=null){const[f,r,i]=this._blind(e,t),s=f.jmul(r);return i?s.add(i):s}jmulAdd(e,t,f){return this.curve.endo&&this.type===n?this.curve._endoWnafMulAdd([this,t],[e,f]):this.curve._wnafMulAdd(5,[this,t],[e,f])}jmulH(){const e=this.curve.h.word(0);if(0===(e&e-1)){const e=this.curve.h.bitLength();return this.toJ().dblp(e-1)}return this.jmul(this.curve.h)}jdiv(e){return P(e instanceof s),P(!e.red),this.jmul(e.invert(this.curve.n))}jdivn(e){return P(!this.curve.n.isZero()),0===this.curve.h.cmpn(e)?this.jdivH():this.jdiv(new s(e))}jdivH(){return this.curve.n.isZero()||0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}toP(){return this.normalize()}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();const e=this.getX().toString(16),t=this.getY().toString(16);return`${this.curve.uid}:${e},${t}`}encode(e){throw new Error("Not implemented.")}static decode(e,t){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(e,t){throw new Error("Not implemented.")}static decodeEven(e,t){throw new Error("Not implemented.")}static decodeSquare(e,t){throw new Error("Not implemented.")}toJSON(e){throw new Error("Not implemented.")}static fromJSON(e,t){throw new Error("Not implemented.")}[i](){return"<Point>"}}class b extends l{constructor(e){super(p,"short",e),this.a=s.fromJSON(e.a).toRed(this.red),this.b=s.fromJSON(e.b).toRed(this.red),this.c=s.fromJSON(e.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.pmodn=this.p.clone(),this.highOrder=this.n.cmp(this.p)>=0,this.smallGap=!1,this._finalize(e)}_finalize(e){return super._finalize(e),null!=e.endo?this.endo=x.fromJSON(this,e.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}static _isomorphism(e,t,f,r){if(P(e instanceof s),P(t instanceof s),P(f instanceof s),P(null==r||"boolean"===typeof r),P(!e.isZero()||!t.isZero()),f.isZero())throw new Error("Invalid coefficient.");if(e.isZero()){const r=f;return P(1===F(r.redDiv(t)).redJacobi()),[e.clone(),r.clone()]}if(t.isZero()){const r=f,i=r.redDiv(e).redSqrt();if(1!==i.redJacobi()&&i.redINeg(),1!==i.redJacobi())throw new Error("Invalid `a` coefficient.");return[r.clone(),t.clone()]}const i=f,n=i.redDiv(e),d=n.redSqrt();if(null!=r?d.redIsOdd()!==r&&d.redINeg():1!==d.redJacobi()&&d.redINeg(),1!==d.redJacobi())throw new Error("Invalid `a` coefficient.");const o=n.redMul(d),h=e.redMul(n),u=t.redMul(o);return P(h.eq(i)),[h,u]}_short(e,t){return b._isomorphism(this.a,this.b,e,t)}_mont(e,t){const[f,r]=this._findRS(t),i=r.redInvert(),s=f.redMuln(3).redMul(i);return null!=e?S._isomorphism(s,i,e):[s,i]}_edwards(e,t){const[f,r]=this._findRS(t),i=f.redMuln(3),s=r.redMuln(2),n=i.redAdd(s),d=i.redSub(s);return null!=e?M._isomorphism(n,d,e):[n,d]}_findRS(e){P(null==e||"boolean"===typeof e),P(this.h.word(0)>=4),P(!this.n.isZero());const t=this.one.redNeg();let f;for(;;){t.redIAdd(this.one);try{f=this.pointFromX(t.clone())}catch(s){continue}if(f=f.mul(this.n),!f.isInfinity()&&f.y.isZero())break}const r=f.x,i=r.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=e&&i.redIsOdd()!==e&&i.redINeg(),[r,i]}_scale0(e,t){if(P(this.a.isZero()===e.isZero()),P(this.b.isZero()===t.isZero()),this.a.isZero()){const e=this.b.redDiv(this.field(t)),f=F(e),r=f.redSqrt(),i=f.redMul(r);return P(i.redSqr().eq(e)),P(!r.isZero()),[f,i]}if(this.b.isZero()){const t=this.a.redDiv(this.field(e)),f=t.redSqrt();1!==f.redJacobi()&&f.redINeg();const r=f.redSqrt(),i=f.redMul(r);return P(i.redMul(r).eq(t)),P(!r.isZero()),[f,i]}const f=this.a.redDiv(this.field(e)),r=this.b.redDiv(this.field(t)),i=f.redSqrt();f.redMul(i).eq(r)||i.redINeg(),P(f.redMul(i).eq(r));const s=i.redSqrt(),n=i.redMul(s);return P(!s.isZero()),[i,n]}_scale1(e,t){const f=this.g.x.redDiv(this.field(e)),r=this.g.y.redDiv(this.field(t)),i=f.redSqrt();return f.redMul(i).eq(r)||i.redINeg(),P(f.redMul(i).eq(r)),P(!i.isZero()),[f,r]}_scaleShort(e){return P(e instanceof b),this.g.isInfinity()||e.g.isInfinity()?this._scale0(e.a,e.b):this._scale1(e.g.x,e.g.y)}_scaleMont(e){if(P(e instanceof S),this.g.isInfinity()||e.g.isInfinity()){const[t,f]=e._short();return this._scale0(t,f)}const{x:t,y:f}=e.g,r=t.redAdd(e.a3).redMul(e.bi),i=f.redMul(e.bi);return this._scale1(r,i)}_scaleEdwards(e){if(P(e instanceof M),this.g.isInfinity()||e.g.isInfinity()){const[t,f]=e._short();return this._scale0(t,f)}const{x:t,y:f,z:r}=e.g,i=e.a.redMuln(5),s=e.d.redMuln(5),n=e.d.redSub(e.a),d=s.redSub(e.a),o=e.d.redSub(i),h=f.redAdd(r),u=f.redSub(r),c=d.redMul(f).redIAdd(o.redMul(r)),l=u.redMuln(12),a=n.redMul(h).redMul(r),b=u.redMul(t).redIMuln(4),p=l.redMul(b).redInvert(),m=c.redMul(b).redMul(p),S=a.redMul(l).redMul(p);return this._scale1(m,S)}_getEndomorphism(e=0){if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;const[t,f]=this._getEndoRoots(this.p),r=[t,f][1&e].toRed(this.red),[i,s]=this._getEndoRoots(this.n),n=this.point(this.g.x.redMul(r),this.g.y);let d;this.g.mul(i).eq(n)?d=i:(P(this.g.mul(s).eq(n)),d=s);const o=this._getEndoBasis(d),h=this._getEndoPrecomp(o);return new x(r,d,o,h)}_getEndoRoots(e){const t=e===this.p?this.red:s.mont(e),f=new s(2).toRed(t),r=new s(3).toRed(t),i=f.redInvert(),n=r.redNeg().redSqrt().redMul(i),d=n.redNeg();return[n.redSub(i).fromRed(),d.redSub(i).fromRed()].sort(s.cmp)}_getEndoBasis(e){const[t,f,r,i,s,n]=this._egcdSqrt(e),d=r,o=i.neg(),h=t.sqr().iadd(f.sqr()),u=s.sqr().iadd(n.sqr());let c,l;return h.cmp(u)<=0?(c=t,l=f.neg()):(c=s,l=n.neg()),[new A(d,o),new A(c,l)]}_egcdSqrt(e){P(e instanceof s),P(!e.red),P(e.sign()>0),P(this.n.sign()>0);const t=this.n.ushrn(this.n.bitLength()>>>1);let f,r,i,n,d,o=e,h=this.n.clone(),u=new s(1),c=new s(0),l=new s(0),a=new s(1),b=0,p=0;for(;!o.isZero()&&b<2;){const e=h.quo(o),s=h.sub(e.mul(o)),m=l.sub(e.mul(u)),S=a.sub(e.mul(c));0===p&&s.cmp(t)<0&&(f=d,r=u,i=s,n=m,p=1),d=s,h=o,o=s,l=u,u=m,a=c,c=S,b+=p}P(0!==p,"Could not find r < sqrt(n).");return[f,r,i,n,l,u]}_getEndoPrecomp(e){P(Array.isArray(e)),P(2===e.length),P(e[0]instanceof A),P(e[1]instanceof A);const[t,f]=e,r=t.a.mul(f.b).isub(t.b.mul(f.a)),i=r.bitLength(),s=i>=160;P(r.eq(this.n));let n,d,o=i+Math.ceil(i/2)+1;for(s&&(o-=63&o);o>i&&(n=f.b.ushln(o).divRound(r),d=t.b.ushln(o).divRound(r),!(n.ucmp(r)<0&&d.ucmp(r)<0));)o-=s?64:1;if(o<=i)throw new Error("Could not calculate g1 and g2.");return[o,n,d]}_endoSplit(e){P(e instanceof s),P(!e.red),P(!this.n.isZero());const[t,f]=this.endo.basis,r=f.b.mul(e).divRound(this.n),i=t.b.neg().mul(e).divRound(this.n),n=r.mul(t.a),d=i.mul(f.a),o=r.ineg().mul(t.b),h=i.mul(f.b);return[e.sub(n).isub(d),o.isub(h)]}_endoBeta(e){return P(e instanceof p),[e,e._getBeta()]}_endoWnafMulAdd(e,t){P(Array.isArray(e)),P(Array.isArray(t)),P(e.length===t.length),P(null!=this.endo);const f=e.length,r=new Array(2*f),i=new Array(2*f);for(let s=0;s<f;s++){const[f,n]=this._endoBeta(e[s]),[d,o]=this._endoSplit(t[s]);r[2*s+0]=f,i[2*s+0]=d,r[2*s+1]=n,i[2*s+1]=o}return this._wnafMulAdd(5,r,i)}_sswu(e){const{b:t,z:f,ai:r,zi:i,one:s}=this,n=f.redSqr(),d=t.redNeg().redMul(r),o=t.redMul(i).redMul(r),h=e.redSqr(),u=h.redSqr(),c=n.redMul(u).redIAdd(f.redMul(h)),l=c.isZero()?c:c.redInvert(),a=l.isZero()?o:d.redMul(s.redAdd(l)),b=f.redMul(h).redMul(a),p=this.solveY2(a),m=this.solveY2(b),S=0|p.redIsSquare(),w=[a,b][1^S],I=[p,m][1^S].redSqrt();return I.redIsOdd()!==e.redIsOdd()&&I.redINeg(),this.point(w,I)}_sswui(e,t){const{a:f,b:r,z:i}=this,{x:s,y:n}=e,d=3&t,o=f.redSqr().redMul(s.redSqr()),h=f.redMul(r).redMul(s).redIMuln(2),u=r.redSqr().redMuln(3),c=f.redMul(s).redIAdd(r),l=o.redISub(h).redISub(u).redSqrt(),a=c.redSub(l).redINeg(),b=c.redAdd(l).redINeg(),p=[c.redMul(i).redIMuln(2),r.redMul(i).redIMuln(2)][d>>>1],m=[a,b][1&d].redDivSqrt(p);return m.redIsOdd()!==n.redIsOdd()&&m.redINeg(),m}_svdwf(e){const{c:t,z:f,zi:r,i2:i,i3:s}=this,n=this.solveY2(f),d=s.redMul(r.redSqr()),o=e.redSqr(),h=o.redSqr(),u=o.redAdd(n),c=o.redMul(u),l=c.isZero()?c:c.redInvert(),a=h.redMul(l).redMul(t),b=u.redSqr().redMul(u),p=t.redSub(f).redMul(i).redISub(a),m=a.redSub(t.redAdd(f).redMul(i)),S=f.redSub(b.redMul(l).redMul(d)),w=this.solveY2(p),I=this.solveY2(m),M=this.solveY2(S),v=function(e,t){let f=e%t;f<0&&(t<0?f-=t:f+=t);return f}(((1|w.redJacobi())-1)*(1|I.redJacobi()),3);return[[p,m,S][v],[w,I,M][v]]}_svdw(e){const[t,f]=this._svdwf(e),r=f.redSqrt();return r.redIsOdd()!==e.redIsOdd()&&r.redINeg(),this.point(t,r)}_svdwi(e,t){const{b:f,c:r,z:i,zero:s,two:n}=this,{x:d,y:o}=e,h=3&t,u=i.redSqr(),c=u.redMul(i),l=u.redSqr(),a=c.redAdd(f),b=a.redMuln(2),p=d.redSqr(),m=d.redMuln(2).redIAdd(i),S=d.redMul(u),w=r.redSub(m),I=r.redAdd(m),M=p.redMul(u).redIAdd(l).redIMuln(9),v=d.redMul(c).redIMuln(18),y=a.redMul(d.redSub(i)).redIMuln(12),g=(h>=2?M.redISub(v).redIAdd(y).redSqrt():s).redMul(i),N=c.redISub(S).redIMuln(3).redISub(b),z=a.redMul(w),q=a.redMul(I),x=N.redAdd(g),A=N.redSub(g),_=[I,w,n,n][h],O=[z,q,x,A][h].redDivSqrt(_),[E]=this._svdwf(O);if(!E.eq(d))throw new Error("Invalid point.");return O.redIsOdd()!==o.redIsOdd()&&O.redINeg(),O}isElliptic(){const{a:e,b:t}=this,f=e.redSqr().redMul(e);return!t.redSqr().redMuln(27).redIAdd(f.redMuln(4)).isZero()}jinv(){const{a:e,b:t}=this,f=e.redSqr().redMul(e),r=t.redSqr(),i=f.redMuln(4),s=i.redMuln(1728),n=r.redMuln(27).redIAdd(i);if(n.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(n).fromRed()}point(e,t){return new p(this,e,t)}jpoint(e,t,f){return new m(this,e,t,f)}solveX(e){if(P(e instanceof s),!this.a.isZero())throw new Error("Not implemented.");return Z(e.redSqr().redSub(this.b))}solveY2(e){P(e instanceof s);const t=e.redSqr().redMul(e).redIAdd(this.b);return this.zeroA||(this.threeA?t.redIAdd(e.redMuln(-3)):t.redIAdd(this.a.redMul(e))),t}validate(e){if(P(e instanceof p),e.inf)return!0;const{x:t,y:f}=e,r=this.solveY2(t);return f.redSqr().eq(r)}pointFromX(e,t=null){P(e instanceof s),P(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const f=this.solveY(e);if(null!=t){if(this.h.cmpn(1)>0&&f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}pointFromY(e,t=0){P(e instanceof s),P(t>>>0===t),e.red||(e=e.toRed(this.red));const f=this.solveX(e);if(t>=f.length)throw new Error("Invalid X coordinate index.");const r=f[t];return this.point(r,e)}isIsomorphic(e){if(P(e instanceof l),!e.p.eq(this.p))return!1;let t,f;try{[t,f]=this._scale(e)}catch(r){return!1}if("short"===e.type){const r=this.field(e.a).redMul(t.redSqr()),i=this.field(e.b).redMul(f.redSqr());return this.a.eq(r)&&this.b.eq(i)}if("mont"===e.type){const{a3:f,bi:r}=e,i=this.field(f.redMul(r)).redMul(t);return this.solveY2(i).isZero()}if("edwards"===e.type){const f=this.field(e.ad6).redMul(t);return this.solveY2(f).isZero()}return!1}isIsogenous(e){return P(e instanceof l),!1}pointFromShort(e){if(P(e instanceof p),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const[t,f]=this._scale(e.curve),r=this.field(e.x),i=this.field(e.y),s=r.redMul(t),n=i.redMul(f);return this.point(s,n)}throw new Error("Not implemented.")}pointFromMont(e){if(P(e instanceof w),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,bi:f}=e.curve,[r,i]=this._scale(e.curve),s=e.x.redAdd(t).redMul(f),n=e.y.redMul(f);return this.point(this.field(s).redMul(r),this.field(n).redMul(i))}throw new Error("Not implemented.")}pointFromEdwards(e){if(P(e instanceof v),this.isIsomorphic(e.curve)){const{a:t,d:f,ad6:r}=e.curve,[i,s]=this._scale(e.curve);if(e.isInfinity())return this.point();if(e.x.isZero()){const e=this.field(r).redMul(i);return this.point(e,this.zero)}const{x:n,y:d,z:o}=e,h=t.redMuln(5),u=f.redMuln(5),c=f.redSub(t),l=u.redSub(t),a=f.redSub(h),b=d.redAdd(o),p=d.redSub(o),m=l.redMul(d).redIAdd(a.redMul(o)),S=p.redMuln(12),w=c.redMul(b).redMul(o),I=p.redMul(n).redIMuln(4);return this.cpoint(this.field(m).redMul(i),this.field(S),this.field(w).redMul(s),this.field(I))}throw new Error("Not implemented.")}pointFromUniform(e){if(P(e instanceof s),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(e);if(!this.c.isZero())return this._svdw(e);throw new Error("Not implemented.")}pointToUniform(e,t){if(P(e instanceof p),P(t>>>0===t),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const f=(t>>>4&15)%this.torsion.length,r=e.add(this.torsion[f]);return R((()=>{if(!this.a.isZero())return this._sswui(r,t);if(!this.c.isZero())return this._svdwi(r,t);throw new Error("Not implemented.")}))}mulAll(e,t){return super.mulAll(e,t).toP()}affinizeAll(e){const t=this.normalizeAll(e);for(let f=0;f<t.length;f++)t[f]=t[f].toP();return t}decodePoint(e){return p.decode(this,e)}encodeX(e){return P(e instanceof a),e.encodeX()}decodeEven(e){return p.decodeEven(this,e)}decodeSquare(e){return p.decodeSquare(this,e)}toShort(e,t,f=null){const[r,i]=this._short(e,t),s=new b({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h});if(null!=f){const[,e]=s._scale(this);e.redIsOdd()!==f&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]);return s}toMont(e,t,f=null){const[r,i]=this._mont(e,t),s=new S({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h});if(null!=f){const[,e]=this._scale(s);e.redIsOdd()!==f&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]);return s}toEdwards(e,t,f=null){const[r,i]=this._edwards(e,t),s=new M({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h});if(null!=f){const[,e]=this._scale(s);e.redIsOdd()!==f&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromShort(this.g),s.g.normalize()),s.isComplete())for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]),s.torsion[n].normalize();return s}pointFromJSON(e){return p.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),this.c.isZero()||(t.c=this.c.fromRed().toJSON()),t}}class p extends a{constructor(e,t,f){P(e instanceof b),super(e,n),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,null!=t&&this._init(t,f)}_init(e,t){P(e instanceof s),P(t instanceof s),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;const e=this.x.redMul(this.curve.endo.beta),t=this.curve.point(e,this.y);return this.pre&&(t.pre=this.pre.map((e=>{const t=e.x.redMul(this.curve.endo.beta);return this.curve.point(t,e.y)})),this.pre.beta=t),t}_getJNAF(e){if(P(e instanceof p),this.inf||e.inf)return super._getJNAF(e);const t=[this,null,null,e];return this.y.eq(e.y)?(t[1]=this.add(e),t[2]=this.toJ().sub(e)):this.y.eq(e.y.redNeg())?(t[1]=this.toJ().add(e),t[2]=this.sub(e)):(t[1]=this.toJ().add(e),t[2]=this.toJ().sub(e)),t}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(e){return this.toJ().scale(e)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(P(e instanceof p),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();if(this.y.eq(e.y)){const t=this.x.redNeg().redISub(e.x),f=this.y.redNeg();return this.curve.point(t,f)}const t=this.x.redSub(e.x),f=this.y.redSub(e.y).redDiv(t),r=f.redSqr().redISub(this.x).redISub(e.x),i=f.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),t=this.y.redMuln(2),f=e.redDiv(t),r=f.redSqr().redISub(this.x).redISub(this.x),i=f.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)}dblp(e){return this.toJ().dblp(e).toP()}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return P(e instanceof p),this===e||(this.inf?e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return P(e instanceof p),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}isSquare(){return!this.inf&&-1!==this.y.redJacobi()}eqX(e){return P(e instanceof s),P(!e.red),!this.inf&&this.getX().eq(e)}eqR(e){return P(e instanceof s),P(!e.red),P(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(e)}mul(e){return super.mul(e).toP()}muln(e){return super.muln(e).toP()}mulBlind(e,t){return super.mulBlind(e,t).toP()}mulAdd(e,t,f){return super.mulAdd(e,t,f).toP()}mulH(){return super.mulH().toP()}div(e){return super.div(e).toP()}divn(e){return super.divn(e).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(e){null==e&&(e=!0),P("boolean"===typeof e);const{fieldSize:t}=this.curve;if(this.inf)throw new Error("Invalid point.");if(e){const e=r.alloc(1+t),f=this.curve.encodeField(this.getX());return e[0]=2|this.y.redIsOdd(),f.copy(e,1),e}const f=r.alloc(1+2*t),i=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return f[0]=4,i.copy(f,1),s.copy(f,1+t),f}static decode(e,t){P(e instanceof b),P(r.isBuffer(t));const f=e.fieldSize;if(t.length<1+f)throw new Error("Not a point.");const i=t[0];switch(i){case 2:case 3:{if(t.length!==1+f)throw new Error("Invalid point size for compressed.");const r=e.decodeField(t.slice(1,1+f));if(r.cmp(e.p)>=0)throw new Error("Invalid point.");const s=e.pointFromX(r,3===i);return P(!s.isInfinity()),s}case 4:case 6:case 7:{if(t.length!==1+2*f)throw new Error("Invalid point size for uncompressed.");const r=e.decodeField(t.slice(1,1+f)),s=e.decodeField(t.slice(1+f,1+2*f));if(r.cmp(e.p)>=0||s.cmp(e.p)>=0)throw new Error("Invalid point.");if(4!==i&&i!==(6|s.isOdd()))throw new Error("Invalid hybrid encoding.");const n=e.point(r,s);if(!n.validate())throw new Error("Invalid point.");return P(!n.isInfinity()),n}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(e,t){P(e instanceof b);const f=e.decodeField(t);if(f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(f,!1)}static decodeSquare(e,t){P(e instanceof b);const f=e.decodeField(t);if(f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(f)}toJSON(e){if(this.inf)return[];const t=this.getX().toJSON(),f=this.getY().toJSON();return!0===e&&this.pre?[t,f,this.pre.toJSON()]:[t,f]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(P(e instanceof b),P(Array.isArray(t)),P(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const f=s.fromJSON(t[0]),r=s.fromJSON(t[1]),i=e.point(f,r);return t.length>2&&null!=t[2]&&(i.pre=y.fromJSON(i,t[2])),i}[i](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class m extends a{constructor(e,t,f,r){P(e instanceof b),super(e,d),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=!1,null!=t&&this._init(t,f,r)}_init(e,t,f){P(e instanceof s),P(t instanceof s),P(null==f||f instanceof s),this.x=e,this.y=t,this.z=f||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x,this.y,this.z)}validate(){const{a:e,b:t}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());const f=this.y.redSqr(),r=this.x.redSqr().redMul(this.x),i=this.z.redSqr(),s=i.redSqr(),n=s.redMul(i),d=r.redIAdd(t.redMul(n));return this.curve.zeroA||(this.curve.threeA?d.redIAdd(s.redIMuln(-3).redMul(this.x)):d.redIAdd(e.redMul(s).redMul(this.x))),f.eq(d)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;const e=this.z.redInvert(),t=e.redSqr();return this.x=this.x.redMul(t),this.y=this.y.redMul(t).redMul(e),this.z=this.curve.one,this.zOne=!0,this}scale(e){if(P(e instanceof s),this.isInfinity())return this.curve.jpoint();const t=e.redSqr(),f=this.x.redMul(t),r=this.y.redMul(t).redMul(e),i=this.z.redMul(e);return this.curve.jpoint(f,r,i)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(e){return P(e instanceof a),e.type===n?this._mixedAdd(e):this._add(e)}_add(e){return P(e instanceof m),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._addJA(this):e.zOne?this._addJA(e):this._addJJ(e)}_mixedAdd(e){return P(e instanceof p),this.isInfinity()?e.toJ():e.isInfinity()?this:this._addJA(e)}_addJJ(e){const t=this.z.redSqr(),f=e.z.redSqr(),r=this.x.redMul(f),i=e.x.redMul(t),s=this.y.redMul(e.z).redMul(f),n=e.y.redMul(this.z).redMul(t),d=i.redISub(r),o=n.redISub(s);if(d.isZero())return o.isZero()?this.dbl():this.curve.jpoint();const h=d.redSqr(),u=d.redMul(h),c=r.redMul(h),l=o.redSqr().redISub(u).redISub(c).redISub(c),a=o.redMul(c.redISub(l)).redISub(s.redMul(u)),b=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(l,a,b)}_addJA(e){const t=this.z.redSqr(),f=e.x.redMul(t),r=e.y.redMul(this.z).redMul(t),i=f.redISub(this.x),s=r.redISub(this.y).redIMuln(2);if(i.isZero())return s.isZero()?this.dbl():this.curve.jpoint();const n=i.redMuln(2).redSqr(),d=i.redMul(n),o=this.x.redMul(n),h=s.redSqr().redISub(d).redISub(o).redISub(o),u=s.redMul(o.redISub(h)).redISub(this.y.redMul(d).redIMuln(2)),c=this.z.redMul(i).redIMuln(2);return this.curve.jpoint(h,u,c)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){const e=this.x.redSqr(),t=this.y.redSqr(),f=this.z.redSqr(),r=this.x.redMul(t).redIMuln(4),i=e.redIMuln(3).redIAdd(this.curve.a.redMul(f.redSqr())),s=i.redSqr().redISub(r).redISub(r),n=s,d=i.redMul(r.redISub(s)).redISub(t.redSqr().redIMuln(8)),o=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(n,d,o)}_dbl0(){const e=this.x.redSqr(),t=this.y.redSqr(),f=t.redSqr(),r=t.redIAdd(this.x).redSqr().redISub(e).redISub(f).redIMuln(2),i=e.redIMuln(3),s=i.redSqr().redISub(r).redISub(r),n=i.redMul(r.redISub(s)).redISub(f.redIMuln(8)),d=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(s,n,d)}_dbl3(){const e=this.z.redSqr(),t=this.y.redSqr(),f=this.x.redMul(t),r=this.x.redSub(e),i=this.x.redAdd(e),s=r.redMul(i).redIMuln(3),n=f.redIMuln(4),d=n.redMuln(2),o=t.redSqr().redIMuln(8),h=s.redSqr().redISub(d),u=this.y.redAdd(this.z).redSqr().redISub(t).redISub(e),c=s.redMul(n.redISub(h)).redISub(o);return this.curve.jpoint(h,c,u)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(e){if(P(e instanceof m),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.z.redSqr(),f=e.z.redSqr(),r=this.x.redMul(f),i=e.x.redMul(t);if(!r.eq(i))return!1;const s=t.redMul(this.z),n=f.redMul(e.z),d=this.y.redMul(n),o=e.y.redMul(s);return d.eq(o)}cmp(e){P(e instanceof m);const t=this.isInfinity(),f=e.isInfinity();return t&&!f?-1:!t&&f?1:t&&f?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.y.isZero()}isOdd(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}isEven(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}isSquare(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}eqX(e){if(P(e instanceof s),P(!e.red),this.isInfinity())return!1;const t=this.z.redSqr(),f=e.toRed(this.curve.red).redMul(t);return this.x.eq(f)}eqR(e){if(P(e instanceof s),P(!e.red),!this.curve.smallGap)return this.toP().eqR(e);if(this.isInfinity())return!1;if(e.cmp(this.curve.p)>=0)return!1;const t=this.z.redSqr(),f=e.toRed(this.curve.red).redMul(t);if(this.x.eq(f))return!0;if(this.curve.highOrder)return!1;if(e.cmp(this.curve.pmodn)>=0)return!1;const r=this.curve.redN.redMul(t);return f.redIAdd(r),this.x.eq(f)}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(e){return this.toP().encode(e)}static decode(e,t){return p.decode(e,t).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(e,t){return p.decodeEven(e,t).toJ()}static decodeSquare(e,t){return p.decodeSquare(e,t).toJ()}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return p.fromJSON(e,t).toJ()}[i](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class S extends l{constructor(e){super(w,"mont",e),this.a=s.fromJSON(e.a).toRed(this.red),this.b=s.fromJSON(e.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(e)}static _isomorphism(e,t,f){P(e instanceof s),P(t instanceof s),P(f instanceof s);const r=e.clone(),i=f.clone();if(1!==t.redDiv(f).redJacobi())throw new Error("Invalid `b` coefficient.");return[r,i]}_short(e,t){const{a:f,b:r,three:i}=this,s=f.redSqr(),n=s.redMul(f),d=r.redSqr(),o=d.redMul(r),h=i.redSub(s),u=d.redMuln(3),c=n.redMuln(2).redISub(f.redMuln(9)),l=o.redMuln(27),a=h.redDiv(u),p=c.redDiv(l);return null!=e?b._isomorphism(a,p,e,t):[a,p]}_mont(e){return S._isomorphism(this.a,this.b,e)}_edwards(e,t=!1){P("boolean"===typeof t);const{two:f,bi:r}=this,i=this.a.redAdd(f).redMul(r),s=this.a.redSub(f).redMul(r);return t&&i.swap(s),null!=e?M._isomorphism(i,s,e):[i,s]}_scaleShort(e){P(e instanceof b);const[t,f]=e._scale(this);return[this.field(t.redInvert()),this.field(f.redInvert())]}_scaleMont(e){return P(e instanceof S),this.g.isInfinity()||e.g.isInfinity()?this.field(e.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(e.g.y))}_scaleEdwards(e,t){P(e instanceof M);const f=e._scale(this,t);return this.field(f)}_solveY0(e){P(e instanceof s);const t=this.a0,f=this.b0,r=e.redSqr();return r.redMul(e).redIAdd(t.redMul(r)).redIAdd(f.redMul(e))}_elligator2(e){const t=this.a0.redNeg(),f=this.one.redAdd(this.z.redMul(e.redSqr()));f.isZero()&&f.inject(this.one);const r=t.redMul(f.redInvert()),i=r.redNeg().redISub(this.a0),s=this._solveY0(r),n=this._solveY0(i),d=0|s.redIsSquare(),o=[r,i][1^d],h=[s,n][1^d].redSqrt();h.redIsOdd()!==e.redIsOdd()&&h.redINeg();const u=this.b.redMul(o),c=this.b.redMul(h);return this.point(u,c)}_invert2(e,t){const{x:f,y:r}=e,i=1&t,s=f.redMul(this.bi),n=r.redMul(this.bi),d=s.redAdd(this.a0),o=s,h=[d,o][i].redINeg(),u=[o,d][i].redMul(this.z),c=h.redDivSqrt(u);return c.redIsOdd()!==n.redIsOdd()&&c.redINeg(),c}isElliptic(){const e=this.a.redSqr();return!this.b.redMul(e.redSub(this.four)).isZero()}jinv(){const{a:e,three:t,four:f}=this,r=e.redSqr(),i=r.redSub(t).redPown(3).redIMuln(256),s=r.redSub(f);if(s.isZero())throw new Error("Curve is not elliptic.");return i.redDiv(s).fromRed()}point(e,t){return new w(this,e,t)}jpoint(e,t,f){return P(null==e&&null==t&&null==f),this.point()}xpoint(e,t){return new I(this,e,t)}solveY2(e){P(e instanceof s);const t=e.redSqr();return t.redMul(e).redIAdd(this.a.redMul(t)).redIAdd(e).redMul(this.bi)}validate(e){if(P(e instanceof w),e.isInfinity())return!0;const{x:t,y:f}=e,r=this.solveY2(t);return f.redSqr().eq(r)}pointFromX(e,t=null){P(e instanceof s),P(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const f=this.solveY(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}isIsomorphic(e,t){if(P(e instanceof l),!e.p.eq(this.p))return!1;if("mont"===e.type){const t=this.field(e.a),f=this.field(e.b);if(!this.a.eq(t))return!1;if(this.b.isZero())return!1;return 1===f.redDiv(this.b).redJacobi()}return e.isIsomorphic(this,t)}isIsogenous(e){return P(e instanceof l),"mont"!==e.type&&e.isIsogenous(this)}pointFromShort(e){if(P(e instanceof p),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,b:f}=this,[r,i]=this._scale(e.curve),s=this.field(e.x).redMul(r),n=this.field(e.y).redMul(i),d=f.redMul(s).redISub(t),o=f.redMul(n);return this.point(d,o)}throw new Error("Not implemented.")}pointFromMont(e){if(P(e instanceof w),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const t=this._scale(e.curve),f=this.field(e.x),r=this.field(e.y),i=f,s=t.redMul(r);return this.point(i,s)}throw new Error("Not implemented.")}pointFromEdwards(e){P(e instanceof v),P(e.curve.p.eq(this.p));const t=this.field(e.x),f=this.field(e.y),r=this.field(e.z);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const i=r.redSqr().redIMuln(2),s=f.redSqr(),n=t.redSqr(),d=i.redISub(n).redISub(s).redMul(f),o=n.redMul(t);return this.cpoint(s,n,d,o)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const i=this._scale(e.curve,!0),s=f.redAdd(r),n=f.redSub(r),d=i.redMul(r).redMul(s),o=t.redMul(n);return this.cpoint(s,n,d,o)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const i=this._scale(e.curve,!1),s=r.redAdd(f),n=r.redSub(f),d=i.redMul(r).redMul(s),o=t.redMul(n);return this.cpoint(s,n,d,o)}throw new Error("Not implemented.")}pointFromUniform(e){if(P(e instanceof s),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(e)}pointToUniform(e,t){if(P(e instanceof w),P(t>>>0===t),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const f=(t>>>4&15)%this.torsion.length,r=e.add(this.torsion[f]);return R((()=>this._invert2(r,t)))}decodePoint(e,t){return w.decode(this,e,t)}encodeX(e){return P(e instanceof I),e.encode()}decodeX(e){return I.decode(this,e)}toShort(e,t,f=null){const[r,i]=this._short(e,t),s=new b({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h});if(null!=f){const[,e]=s._scale(this);e.redIsOdd()!==f&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromMont(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromMont(this.torsion[n]);return s}toMont(e,t=null){const[f,r]=this._mont(e),i=new S({red:this.red,prime:this.prime,p:this.p,a:f,b:r,n:this.n,h:this.h,z:this.z});if(null!=t){const e=i._scale(this);e.redIsOdd()!==t&&e.redINeg()}this.g.isInfinity()||(i.g=i.pointFromMont(this.g));for(let s=0;s<this.h.word(0);s++)i.torsion[s]=i.pointFromMont(this.torsion[s]);return i}toEdwards(e,t,f=null){const[r,i]=this._edwards(e,t),s=new M({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h,z:this.z});if(null!=f){const e=s._scale(this,t);e.redIsOdd()!==f&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromMont(this.g),s.g.normalize()),s.isComplete())for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromMont(this.torsion[n]),s.torsion[n].normalize();return s}pointFromJSON(e){return w.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),t}}class w extends a{constructor(e,t,f){P(e instanceof S),super(e,n),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=!0,null!=t&&this._init(t,f)}_init(e,t){P(e instanceof s),P(t instanceof s),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1}clone(){return this.inf?this.curve.point():this.curve.point(this.x,this.y)}scale(e){return this.clone()}randomize(e){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(P(e instanceof w),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();const t=e.x.redSub(this.x),f=e.y.redSub(this.y).redDiv(t),r=this.curve.b.redMul(f.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),i=f.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3),t=this.curve.a.redMul(this.x).redIMuln(2),f=e.redIAdd(t).redIAdd(this.curve.one),r=this.curve.b.redMul(this.y).redIMuln(2),i=f.redDiv(r),s=this.curve.b.redMul(i.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),n=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,n)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return P(e instanceof w),this===e||(this.inf?e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return P(e instanceof w),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(e,t,f){return P(e instanceof S),e.decodeX(t).toP(f)}toJSON(e){if(this.inf)return[];return[this.getX().toJSON(),this.getY().toJSON()]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(P(e instanceof S),P(Array.isArray(t)),P(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const f=s.fromJSON(t[0]),r=s.fromJSON(t[1]);return e.point(f,r)}[i](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class I extends a{constructor(e,t,f){P(e instanceof S),super(e,o),this.x=this.curve.one,this.z=this.curve.zero,null!=t&&this._init(t,f)}_init(e,t){P(e instanceof s),P(null==t||t instanceof s),this.x=e,this.z=t||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x,this.z)}precompute(e,t){return this}validate(){if(this.isInfinity())return!0;const{x:e,z:t}=this,f=e.redSqr(),r=f.redMul(e),i=t.redSqr(),s=this.curve.a.redMul(f).redMul(t);return-1!==r.redIAdd(s).redIAdd(e.redMul(i)).redMul(this.curve.bi).redMul(t).redJacobi()}normalize(){return this.isInfinity()||this.z.eq(this.curve.one)||(this.x=this.x.redDiv(this.z),this.z=this.curve.one),this}scale(e){if(P(e instanceof s),this.isInfinity())return this.curve.xpoint();const t=this.x.redMul(e),f=this.z.redMul(e);return this.curve.xpoint(t,f)}neg(){return this}dbl(){const e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),f=e.redSub(t),r=e.redMul(t),i=f.redMul(t.redIAdd(this.curve.a24.redMul(f)));return this.curve.xpoint(r,i)}diffAddDbl(e,t){P(e instanceof I),P(t instanceof I);const f=e.x.redAdd(e.z),r=f.redSqr(),i=e.x.redSub(e.z),s=i.redSqr(),n=r.redSub(s),d=t.x.redAdd(t.z),o=t.x.redSub(t.z).redMul(f),h=d.redMul(i),u=this.z.redMul(o.redAdd(h).redSqr()),c=this.x.redMul(o.redISub(h).redSqr()),l=r.redMul(s),a=n.redMul(s.redIAdd(this.curve.a24.redMul(n)));return[this.curve.xpoint(l,a),this.curve.xpoint(u,c)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(e){return this.toP(e).getY()}eq(e){if(P(e instanceof I),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x);const t=this.x.redMul(e.z),f=e.x.redMul(this.z);return t.eq(f)}cmp(e){P(e instanceof I);const t=this.isInfinity(),f=e.isInfinity();return t&&!f?-1:!t&&f?1:t&&f?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return!this.isInfinity()&&(!!this.x.isZero()||super.hasTorsion())}order(){try{return this.toP().order()}catch(e){return new s(1)}}jmul(e){P(e instanceof s),P(!e.red);const t=e.bitLength();let f=this.curve.xpoint(),r=this;for(let i=t-1;i>=0;i--){0===e.bit(i)?[f,r]=this.diffAddDbl(f,r):[r,f]=this.diffAddDbl(r,f)}return f}jmulBlind(e,t){return t?this.randomize(t).jmul(e):this.jmul(e)}jmulAdd(e,t,f){throw new Error("Not implemented.")}toP(e=null){return P(null==e||"boolean"===typeof e),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,e))}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();const e=this.getX().toString(16);return`${this.curve.uid}:${e}`}encode(){return this.curve.encodeField(this.getX())}static decode(e,t){P(e instanceof S);const f=e.decodeField(t);f.iumaskn(e.fieldBits);const r=e.xpoint(f,e.one);return P(!r.isInfinity()),r}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return w.fromJSON(e,t).toX()}[i](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class M extends l{constructor(e){super(v,"edwards",e),this.a=s.fromJSON(e.a).toRed(this.red),this.d=s.fromJSON(e.d).toRed(this.red),this.s=s.fromJSON(e.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=null!=this.prime&&1===this.d.redNeg().length,this.alt=null,this._finalize(e)}static _isomorphism(e,t,f){P(e instanceof s),P(t instanceof s),P(f instanceof s);const r=f.clone(),i=f.redMul(t).redDiv(e);if(1!==e.redDiv(f).redJacobi())throw new Error("Invalid `a` coefficient.");return[r,i]}_short(e,t){const{a:f,d:r}=this,i=f.redSqr(),s=i.redMul(f),n=r.redSqr(),d=n.redMul(r),o=f.redMul(r).redIMuln(14),h=i.redMul(r),u=f.redMul(n),c=h.redIAdd(u).redIMuln(33),l=i.redAdd(o).redIAdd(n).redDivn(-48),a=c.redISub(s).redISub(d).redDivn(864);return null!=e?b._isomorphism(l,a,e,t):[l,a]}_mont(e,t=!1){let f,r;P("boolean"===typeof t),t?(f=this.d.redAdd(this.a),r=this.d.redSub(this.a)):(f=this.a.redAdd(this.d),r=this.a.redSub(this.d));const i=r.redInvert(),s=f.redMuln(2).redMul(i),n=i.redMuln(4);return null!=e?S._isomorphism(s,n,e):[s,n]}_edwards(e){return M._isomorphism(this.a,this.d,e)}_scaleShort(e){P(e instanceof b);const[t,f]=e._scale(this);return[this.field(t.redInvert()),this.field(f.redInvert())]}_scaleMont(e,t=!1){if(P(e instanceof S),P("boolean"===typeof t),this.g.isInfinity()||e.g.isInfinity()){const[f]=e._edwards(null,t);return this.field(f).redDivSqrt(this.a)}const f=e.g.x.redDiv(e.g.y);return this.g.x.redDiv(this.field(f))}_scaleEdwards(e){return P(e instanceof M),this.g.isInfinity()||e.g.isInfinity()?this.field(e.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(e.g.x))}_mulA(e){return P(e instanceof s),this.oneA?e.clone():this.mOneA?e.redNeg():this.a.redMul(e)}_mulD(e){return P(e instanceof s),this.smallD?e.redMuln(this.smi):this.d.redMul(e)}_elligator1(e){const{s:t,si:f,i2:r,one:i,two:s}=this,n=f.redSqr().redIMuln(2),d=t.redSqr().redMul(r),o=d.redSqr(),h=n.redAdd(d),u=h.redSqr().redISub(s),c=n.redSub(i),l=i.redSub(e),a=i.redAdd(e),b=a.isZero()?a:l.redDiv(a),p=b.redSqr(),m=p.redMul(b),S=m.redMul(p).redAdd(u.redMul(m)).redIAdd(b),w=this.field(S.redJacobi()),I=this.field(p.redAdd(o).redJacobi()),M=w.redMul(I),v=w.redMul(b),y=w.redMul(S).redSqrt().redMul(M),g=i.redAdd(v),N=h.redMul(v),z=g.redSqr(),q=c.redMul(t).redMul(v).redMul(g),x=b.isZero()?this.one:y,A=N.redSub(z),_=N.redAdd(z);return this.cpoint(q,x,A,_)}_invert1(e,t){const{s:f,si:r,i2:i,one:s}=this,{x:n,y:d,z:o}=e,h=1&t,u=r.redSqr().redIMuln(2),c=f.redSqr().redMul(i),l=c.redSqr(),a=u.redAdd(c),b=u.redSub(s),p=d.redSub(o),m=d.redAdd(o).redIMuln(2),S=m.isZero()?m:p.redDiv(m),w=s.redAdd(S.redMul(a)),I=w.redSqr().redISub(s).redSqrt().redSub(w),M=s.redAdd(I),v=b.redMul(f).redMul(I).redMul(M).redMul(n.redMul(o)),y=I.redSqr().redIAdd(l),g=this.field(v.redMul(y).redJacobi()).redMul(I),N=s.redSub(g),z=s.redAdd(g),q=z.isZero()?z:N.redDiv(z);return q.redIsOdd()!==Boolean(h)&&q.redINeg(),q}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){const e=this.a.redMul(this.d),t=this.a.redSub(this.d);return!e.redMul(t).isZero()}jinv(){const{a:e,d:t}=this,f=e.redMul(t),r=e.redSub(t).redPown(4),i=e.redSqr(),s=t.redSqr(),n=i.redAdd(f.redMuln(14)).redIAdd(s).redPown(3).redIMuln(16),d=f.redMul(r);if(d.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(d).fromRed()}isComplete(){return 1===this.a.redJacobi()&&-1===this.d.redJacobi()}point(e,t,f,r){return new v(this,e,t,f,r)}jpoint(e,t,f){return P(null==e&&null==t&&null==f),this.point()}cpoint(e,t,f,r){P(e instanceof s),P(t instanceof s),P(f instanceof s),P(r instanceof s);const i=e.redMul(r),n=f.redMul(t),d=t.redMul(r),o=e.redMul(f);return this.point(i,n,d,o)}solveX2(e){P(e instanceof s);const t=e.redSqr(),f=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDiv(f)}solveX(e){const t=e.redSqr(),f=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDivSqrt(f)}solveY2(e){P(e instanceof s);const t=e.redSqr(),f=this._mulA(t).redISub(this.one),r=this._mulD(t).redISub(this.one);return f.redDiv(r)}solveY(e){const t=e.redSqr(),f=this._mulA(t).redISub(this.one),r=this._mulD(t).redISub(this.one);return f.redDivSqrt(r)}validate(e){if(P(e instanceof v),e.zOne){const t=e.x.redSqr(),f=e.y.redSqr(),r=this._mulD(t).redMul(f),i=this._mulA(t).redIAdd(f),s=this.one.redAdd(r),n=e.t,d=e.x.redMul(e.y);return i.eq(s)&&n.eq(d)}const t=e.x.redSqr(),f=e.y.redSqr(),r=e.z.redSqr(),i=r.redSqr(),s=this._mulD(t).redMul(f),n=this._mulA(t).redIAdd(f).redMul(r),d=i.redIAdd(s),o=e.t.redMul(e.z),h=e.x.redMul(e.y);return n.eq(d)&&o.eq(h)}pointFromX(e,t=null){P(e instanceof s),P(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const f=this.solveY(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(e,f)}pointFromY(e,t=null){P(e instanceof s),P(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const f=this.solveX(e);if(null!=t){if(f.isZero()&&t)throw new Error("Invalid point.");f.redIsOdd()!==t&&f.redINeg()}return this.point(f,e)}isIsomorphic(e,t=!1){if(P(e instanceof l),P("boolean"===typeof t),!e.p.eq(this.p))return!1;if("short"===e.type)return e.isIsomorphic(this);if("mont"===e.type){const f=this.field(e.a);let r,i;return t?(r=this.d.redAdd(this.a),i=this.d.redSub(this.a)):(r=this.a.redAdd(this.d),i=this.a.redSub(this.d)),f.redMul(i).eq(r.redIMuln(2))}if("edwards"===e.type){const t=this.field(e.a),f=this.field(e.d);return this.a.redMul(f).eq(t.redMul(this.d))}return!1}isIsogenous(e){if(P(e instanceof l),!e.p.eq(this.p))return!1;if("mont"===e.type){if(!this.a.eq(this.one))return!1;const t=this.field(e.a),f=this.field(e.b),r=this.two.redSub(this.d.redMuln(4));return t.eq(r)&&f.eq(this.one)}if("edwards"===e.type){const t=this.field(e.a),f=this.field(e.d);return t.eq(this.a.redNeg())&&f.eq(this.d.redSub(this.a))}return!1}pointFromShort(e){if(P(e instanceof p),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();if(e.y.isZero())return this.point(this.zero,this.one.redNeg());const{a:t,d:f}=this,[r,i]=this._scale(e.curve),s=t.redMuln(5),n=f.redMuln(5),d=this.field(e.x).redMul(r),o=this.field(e.y).redMul(i),h=d.redMuln(6),u=d.redMuln(12),c=h.redSub(t).redISub(f),l=o.redMuln(6),a=u.redSub(s).redIAdd(f),b=u.redAdd(t).redISub(n);return this.cpoint(c,l,a,b)}throw new Error("Not implemented.")}pointFromMont(e){P(e instanceof w),P(e.curve.p.eq(this.p));const t=this.field(e.x),f=this.field(e.y);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point();const r=t.redSqr(),i=r.redMul(t),s=i.redMul(t),n=s.redMul(t),d=f.redSqr(),o=f.redMuln(4),h=r.redSub(this.one),u=r.redMuln(2),c=d.redMuln(4),l=i.redIMuln(2),a=t.redMul(d).redIMuln(4),b=r.redMul(d).redIMuln(2),p=d.redIMuln(2),m=o.redMul(h),S=s.redISub(u).redIAdd(c).redIAdd(this.one),w=n.redSub(l).redISub(a).redIAdd(t).redINeg(),I=n.redISub(b).redISub(l).redISub(p).redIAdd(t);return this.cpoint(m,S,w,I).divn(4)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const r=this._scale(e.curve,!0).redMul(t),i=f,s=t.redAdd(this.one),n=t.redSub(this.one);return this.cpoint(r,i,s,n)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const r=this._scale(e.curve,!1).redMul(t),i=f,s=t.redSub(this.one),n=t.redAdd(this.one);return this.cpoint(r,i,s,n)}throw new Error("Not implemented.")}pointFromEdwards(e){P(e instanceof v),P(e.curve.p.eq(this.p));const t=this.field(e.curve.a),f=this.field(e.x),r=this.field(e.y),i=this.field(e.z),s=this.field(e.t);if(this.isIsogenous(e.curve)){const e=f.redMul(r),s=f.redSqr(),n=r.redSqr(),d=i.redSqr(),o=t.redMul(s),h=e.redIMuln(2),u=n.redSub(o),c=n.redAdd(o),l=d.redIMuln(2).redISub(c),a=this.cpoint(h,u,c,l);return this.twisted?a:a.divn(4)}if(this.isIsomorphic(e.curve)){const t=this._scale(e.curve),n=t.redMul(f),d=r,o=i,h=t.redMul(s);return this.point(n,d,o,h)}throw new Error("Not implemented.")}pointFromUniform(e,t=null){P(e instanceof s),P(e.red===this.red),P(null==t||t instanceof S),t||(t=this._alt());const f=t.field(e),r=t.pointFromUniform(f);return this.pointFromMont(r)}pointToUniform(e,t,f=null){P(e instanceof v),P(t>>>0===t),P(null==f||f instanceof S),f||(f=this._alt());const r=(t>>4&15)%this.torsion.length,i=e.add(this.torsion[r]),s=f.pointFromEdwards(i),n=f.pointToUniform(s,15&t);return this.field(n)}pointFromHash(e,t,f=null){P(null==f||f instanceof S),f||(f=this._alt());const r=f.pointFromHash(e,t);return this.pointFromMont(r)}pointToHash(e,t,f,r=null){P(e instanceof v),P(t>>>0===t),P(null==r||r instanceof S),r||(r=this._alt());const i=t%this.torsion.length,s=e.add(this.torsion[i]),n=r.pointFromEdwards(s);return r.pointToHash(n,0,f)}decodePoint(e){return v.decode(this,e)}toShort(e,t,f=null){const[r,i]=this._short(e,t),s=new b({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h});if(null!=f){const[,e]=s._scale(this);e.redIsOdd()!==f&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromEdwards(this.torsion[n]);return s}toMont(e,t,f=null){const[r,i]=this._mont(e,t),s=new S({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h,z:this.z});if(null!=f){const e=this._scale(s,t);e.redIsOdd()!==f&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromEdwards(this.torsion[n]);return s}toEdwards(e,t=null){const[f,r]=this._edwards(e),i=new M({red:this.red,prime:this.prime,p:this.p,a:f,d:r,n:this.n,h:this.h,z:this.z});if(null!=t){const e=i._scale(this);e.redIsOdd()!==t&&e.redINeg()}if(this.g.isInfinity()||(i.g=i.pointFromEdwards(this.g),i.g.normalize()),i.isComplete())for(let s=0;s<this.h.word(0);s++)i.torsion[s]=i.pointFromEdwards(this.torsion[s]),i.torsion[s].normalize();return i}pointFromJSON(e){return v.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.d=this.d.fromRed().toJSON(),this.s.isZero()||(t.s=this.s.fromRed().toJSON()),t}}class v extends a{constructor(e,t,f,r,i){P(e instanceof M),super(e,h),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0,null!=t&&this._init(t,f,r,i)}_init(e,t,f,r){P(e instanceof s),P(t instanceof s),P(null==f||f instanceof s),P(null==r||r instanceof s),this.x=e,this.y=t,this.z=f||this.curve.one,this.t=r||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x,this.y,this.z,this.t)}normalize(){if(this.zOne)return this;const e=this.z.redInvert();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t=this.t.redMul(e),this.z=this.curve.one,this.zOne=!0,this}scale(e){P(e instanceof s);const t=this.x.redMul(e),f=this.y.redMul(e),r=this.z.redMul(e),i=this.t.redMul(e);return this.curve.point(t,f,r,i)}neg(){const e=this.x.redNeg(),t=this.y,f=this.z,r=this.t.redNeg();return this.curve.point(e,t,f,r)}add(e){return P(e instanceof v),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._add(this):this._add(e)}_add(e){return this.curve.mOneA?this._addM1(e):this._addA(e)}_addM1(e){const t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),f=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.k).redMul(e.t),i=e.zOne?this.z.redAdd(this.z):this.z.redMul(e.z).redIMuln(2),s=f.redSub(t),n=i.redSub(r),d=i.redIAdd(r),o=f.redIAdd(t),h=s.redMul(n),u=d.redMul(o),c=s.redMul(o),l=n.redMul(d);return this.curve.point(h,u,l,c)}_addA(e){const t=this.x.redMul(e.x),f=this.y.redMul(e.y),r=this.curve._mulD(this.t).redMul(e.t),i=e.zOne?this.z.clone():this.z.redMul(e.z),s=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(t).redISub(f),n=i.redSub(r),d=i.redIAdd(r),o=f.redISub(this.curve._mulA(t)),h=s.redMul(n),u=d.redMul(o),c=s.redMul(o),l=n.redMul(d);return this.curve.point(h,u,l,c)}dbl(){return this.isInfinity()?this:this._dbl()}_dbl(){const e=this.x.redSqr(),t=this.y.redSqr(),f=this.zOne?this.curve.two:this.z.redSqr().redIMuln(2),r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=r.redAdd(t),n=s.redSub(f),d=r.redISub(t),o=i.redMul(n),h=s.redMul(d),u=i.redMul(d),c=n.redMul(s);return this.curve.point(o,h,c,u)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(e){if(P(e instanceof v),P(!this.z.isZero()),P(!e.z.isZero()),this===e)return!0;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.x.redMul(e.z),f=e.x.redMul(this.z);if(!t.eq(f))return!1;const r=this.y.redMul(e.z),i=e.y.redMul(this.z);return r.eq(i)}cmp(e){return P(e instanceof v),this.order().cmp(e.order())||this.getY().cmp(e.getY())||this.getX().cmp(e.getX())}isInfinity(){return P(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){const e=this.getY();return e.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(e)}static decode(e,t){P(e instanceof M);const f=e.decodeAdjusted(t),r=0!==f.testn(e.signBit);if(f.setn(e.signBit,0),f.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromY(f,r)}toJSON(e){if(this.isInfinity())return[];const t=this.getX().toJSON(),f=this.getY().toJSON();return!0===e&&this.pre?[t,f,this.pre.toJSON()]:[t,f]}toPretty(){const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(P(e instanceof M),P(Array.isArray(t)),P(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const f=s.fromJSON(t[0]),r=s.fromJSON(t[1]),i=e.point(f,r);return t.length>2&&null!=t[2]&&(i.pre=y.fromJSON(i,t[2])),i}[i](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class y{constructor(){this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}map(e){P("function"===typeof e);const t=new this.constructor;return this.naf&&(t.naf=this.naf.map(e)),this.doubles&&(t.doubles=this.doubles.map(e)),t}toJSON(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}fromJSON(e,t){return P(e instanceof a),P(t&&"object"===typeof t),null!=t.naf&&(this.naf=g.fromJSON(e,t.naf)),null!=t.windows&&(this.windows=N.fromJSON(e,t.windows)),null!=t.doubles&&(this.doubles=z.fromJSON(e,t.doubles)),null!=t.blinding&&(this.blinding=q.fromJSON(e,t.blinding)),this}static fromJSON(e,t){return(new this).fromJSON(e,t)}}class g{constructor(e,t){this.width=e,this.points=t}map(e){P("function"===typeof e);const{width:t}=this,f=[];for(const r of this.points)f.push(e(r));return new this.constructor(t,f)}toJSON(){return{width:this.width,points:this.points.slice(1).map((e=>e.toJSON()))}}static fromJSON(e,t){P(e instanceof a),P(t&&"object"===typeof t),P(t.width>>>0===t.width),P(Array.isArray(t.points));const{curve:f}=e,{width:r}=t,i=[e];for(const s of t.points)i.push(f.pointFromJSON(s));return new this(r,i)}}class N{constructor(e,t,f){this.width=e,this.bits=t,this.points=f}toJSON(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map((e=>e.toJSON()))}}static fromJSON(e,t){P(e instanceof a),P(t&&"object"===typeof t),P(t.width>>>0===t.width),P(t.bits>>>0===t.bits),P(Array.isArray(t.points));const{curve:f}=e,{width:r,bits:i}=t,s=[e];for(const n of t.points)s.push(f.pointFromJSON(n));return new this(r,i,s)}}class z{constructor(e,t){this.step=e,this.points=t}map(e){P("function"===typeof e);const{step:t}=this,f=[];for(const r of this.points)f.push(e(r));return new this.constructor(t,f)}toJSON(){return{step:this.step,points:this.points.slice(1).map((e=>e.toJSON()))}}static fromJSON(e,t){P(e instanceof a),P(t&&"object"===typeof t),P(t.step>>>0===t.step),P(Array.isArray(t.points));const{curve:f}=e,{step:r}=t,i=[e];for(const s of t.points)i.push(f.pointFromJSON(s));return new this(r,i)}}class q{constructor(e,t){this.blind=e,this.unblind=t}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(e,t){P(e instanceof a),P(t&&"object"===typeof t);const{curve:f}=e;return new this(s.fromJSON(t.blind),f.pointFromJSON(t.unblind))}}class x{constructor(e,t,f,r){this.beta=e,this.lambda=t,this.basis=f,this.pre=r}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0],this.pre[1].toJSON(),this.pre[2].toJSON()]}}static fromJSON(e,t){P(e instanceof l),P(t&&"object"===typeof t),P(Array.isArray(t.basis)),P(Array.isArray(t.pre)),P(2===t.basis.length),P(3===t.pre.length),P(t.pre[0]>>>0===t.pre[0]);return new this(s.fromJSON(t.beta).toRed(e.red),s.fromJSON(t.lambda),[A.fromJSON(t.basis[0]),A.fromJSON(t.basis[1])],[t.pre[0],s.fromJSON(t.pre[1]),s.fromJSON(t.pre[2])])}}class A{constructor(e,t){this.a=e,this.b=t}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(e){P(e&&"object"===typeof e);return new this(s.fromJSON(e.a),s.fromJSON(e.b))}}const _={__proto__:null,P192:class extends b{constructor(e){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],e]})}},P224:class extends b{constructor(e){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],e]})}},P256:class extends b{constructor(e){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],e]})}},P384:class extends b{constructor(e){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],e]})}},P521:class extends b{constructor(e){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],e]})}},SECP256K1:class extends b{constructor(e){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],e],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:[384,["3086d221 a7d46bcd e86c90e4 9284eb15","3daa8a14 71e8ca7f e893209a 45dbb031"],["-","e4437ed6 010e8828 6f547fa9 0abfe4c4","221208ac 9df506c6 1571b4ae 8ac47f71"]]}})}},BRAINPOOLP256:class extends b{constructor(e){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],e]})}},BRAINPOOLP384:class extends b{constructor(e){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],e]})}},BRAINPOOLP512:class extends b{constructor(e){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],e]})}},X25519:class extends S{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}},X448:class extends S{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}},MONT448:class extends S{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}},ED25519:class extends M{constructor(e){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}},ISO448:class extends M{constructor(e){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},ED448:class extends M{constructor(e){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}}},O={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function E(e,t,f){P(e instanceof s),P(!e.red),P(t>>>0===t),P(f>>>0===f);const r=new Array(f),i=e.bitLength()+1,n=1|e.sign();P(i<=f);for(let s=0;s<f;s++)r[s]=0;let d,o=0,h=0;for(;o<i;)e.bit(o)!==h?(d=e.bits(o,t)+h,h=d>>t-1&1,d-=h<<t,r[o]=n*d,o+=t):o+=1;return P(0===h),r}function J(e,t,f){const r=function(e,t,f){P(e instanceof s),P(t instanceof s),P(!e.red),P(!t.red),P(f>>>0===f);const r=[new Array(f),new Array(f)],i=Math.max(e.bitLength(),t.bitLength())+1,n=1|e.sign(),d=1|t.sign();P(i<=f);let o=0,h=0;for(let s=0;s<i;s++){const f=e.bits(s,3),i=t.bits(s,3);let u=(3&f)+o&3,c=(3&i)+h&3,l=0,a=0;if(3===u&&(u=-1),3===c&&(c=-1),1&u){const e=(7&f)+o&7;l=3!==e&&5!==e||2!==c?u:-u}if(1&c){const e=(7&i)+h&7;a=3!==e&&5!==e||2!==u?c:-c}r[0][s]=l*n,r[1][s]=a*d,2*o===1+l&&(o=1-o),2*h===1+a&&(h=1-h)}for(let s=i;s<f;s++)r[0][s]=0,r[1][s]=0;return r}(e,t,f),i=new Array(f);for(let s=0;s<f;s++){const e=r[0][s],t=r[1][s];i[s]=u[3*(e+1)+(t+1)]}return i}function P(e,t){if(!e){const e=new Error(t||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(e,P),e}}function R(e){P("function"===typeof e);try{return e()}catch(t){if("X is not a square mod P."===t.message||"Not invertible."===t.message)throw new Error("Invalid point.");throw t}}function Z(e){const t=function(e){P(e instanceof s),P(e.red);const t=e.red.m;if(t.cmpn(3)<=0)return e.clone();if(2===t.modrn(3)){const f=t.ushln(1).isubn(1).idivn(3);return e.redPow(f)}const f=t.modrn(9);if(4===f){const f=t.ushln(1).iaddn(1).idivn(9),r=e.redPow(f);if(!r.redSqr().redMul(r).eq(e))throw new Error("X is not a cube mod P.");return r}if(7===f){const f=t.addn(2).idivn(9),r=e.redPow(f);if(!r.redSqr().redMul(r).eq(e))throw new Error("X is not a cube mod P.");return r}throw new Error("Not implemented.")}(e);if(1===e.red.m.modrn(3)){const f=new s(2).toRed(e.red),r=new s(3).toRed(e.red),i=f.redInvert(),n=r.redNeg().redSqrt().redMul(i),d=n.redNeg(),o=n.redSub(i),h=d.redSub(i),u=t.redMul(o),c=t.redMul(h);return[t,u,c]}return[t]}function F(e){for(const t of Z(e))if(t.redJacobi()>=0)return t;throw new Error("X^(1/3) is not a square mod P.")}function X(e){return s.randomBits(e,32).toNumber()}function j(e,t){const f=new WeakMap;return function(r,i){const s=1&i,n=f.get(r);if(n&&null!==n[s])return n[s];const d=e.call(t,r,i);return f.has(r)||f.set(r,[null,null]),f.get(r)[s]=d,d}}function D(e,t){P(e instanceof s),P(t>>>0===t),7&t&&(t+=8-(7&t));const f=e.toString(16,t),r=[],i=[];P(0===(7&f.length));for(let s=0;s<f.length;s+=8)r.push(f.slice(s,s+8));for(let s=0;s<r.length;s+=4)i.push(r.slice(s,s+4).join(" "));return i}t.Curve=l,t.Point=a,t.ShortCurve=b,t.ShortPoint=p,t.JPoint=m,t.MontCurve=S,t.MontPoint=w,t.XPoint=I,t.EdwardsCurve=M,t.EdwardsPoint=v,t.curves=_,t.curve=function(e,...t){P("string"===typeof e);const f=e.toUpperCase();let r=O[f];if(!r){const i=_[f];if(!i)throw new Error(`Curve not found: "${e}".`);r=new i(...t),O[f]=r}return r},t.register=function(e,t){P("string"===typeof e),P("function"===typeof t);const f=e.toUpperCase();if(_[f])throw new Error(`Curve already registered: "${e}".`);_[f]=t,O[f]=null}}}]);